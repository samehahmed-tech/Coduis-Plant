<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, minimum-scale=1.0">
<title>Authenticate POS</title>

	<meta name="description" content="This API allows taxpayer system to get access token to be used to access other protected APIs of the solution.">


<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,400i,500,500i,700,700i|Noto+Sans:400,400i,700,700i|Source+Code+Pro&amp;subset=latin-ext">
<link rel="stylesheet" href="/doks-theme/assets/css/style.css">
<link type="application/atom+xml" rel="alternate" href="/feed.xml" />
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Authenticate POS</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Authenticate POS" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This API allows taxpayer system to get access token to be used to access other protected APIs of the solution." />
<meta property="og:description" content="This API allows taxpayer system to get access token to be used to access other protected APIs of the solution." />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-12-24T04:12:06-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Authenticate POS" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-12-24T04:12:06-06:00","datePublished":"2024-12-24T04:12:06-06:00","description":"This API allows taxpayer system to get access token to be used to access other protected APIs of the solution.","headline":"Authenticate POS","mainEntityOfPage":{"@type":"WebPage","@id":"/ereceiptapi/01-authenticate-pos/"},"url":"/ereceiptapi/01-authenticate-pos/"}</script>
<!-- End Jekyll SEO tag -->


	</head>
	<body class="yellow" data-spy="scroll" data-target=".js-scrollspy">
		
	<div class="offcanvas visible-xs">
		<ul class="offcanvas__nav">
			
				<li><a href="/release-notes/">Release Notes</a></li>
			
				<li><a href="/api/">API</a></li>
			
				<li><a href="/types/">Types</a></li>
			
				<li><a href="/codes/">Codes</a></li>
			
				<li><a href="/toolkit/home/">Integration Toolkit</a></li>
			
				<li><a href="/faq/">FAQ</a></li>
			
				<li><a href="/contacts/">Contacts</a></li>
			
		</ul><!-- /.offcanvas__nav -->
	</div><!-- /.offcanvas -->



	<header class="site-header">
		<div class="container">
			<div class="row">
				<div class="col-xs-12">
					
						<a href="/" class="site-header__logo">Egyptian eInvoicing & eReceipt SDK</a>
					
					
						<ul class="site-header__nav hidden-xs">
							
							<li>
								<a href="/release-notes/">Release Notes</a>
								
							</li>
							
							<li>
								<a href="/api/">API</a>
								
								<ul>
									
									<li>
										<a href="/api/">COMMON</a>
									</li>
									
									<li>
										<a href="/einvoicingapi/">EINVOICING</a>
									</li>
									
									<li>
										<a href="/ereceiptapi/">ERECEIPT</a>
									</li>
									
									<li>
										<a href="/apigovernance/">APIs Governance & Rate Limiting</a>
									</li>
									
								</ul>
								
							</li>
							
							<li>
								<a href="/types/">Types</a>
								
							</li>
							
							<li>
								<a href="/codes/">Codes</a>
								
							</li>
							
							<li>
								<a href="/toolkit/home/">Integration Toolkit</a>
								
								<ul>
									
									<li>
										<a href="/toolkit/home/#installation">Install</a>
									</li>
									
									<li>
										<a href="/toolkit/home/#configuration-and-administration">Config</a>
									</li>
									
									<li>
										<a href="/toolkit/home/#usage-guide">Usage</a>
									</li>
									
								</ul>
								
							</li>
							
							<li>
								<a href="/faq/">FAQ</a>
								
								<ul>
									
									<li>
										<a href="/integrationpractices/">Integration Practices</a>
									</li>
									
									<li>
										<a href="/receiptissuancefaq/">RECEIPT ISSUANCE FAQ</a>
									</li>
									
								</ul>
								
							</li>
							
							<li>
								<a href="/contacts/">Contacts</a>
								
							</li>
							
						</ul><!-- /.site-header__nav -->
						<button class="offcanvas-toggle visible-xs">
							<span></span>
							<span></span>
							<span></span>
						</button><!-- /.offcanvas-toggle -->
					
				</div><!-- /.col -->
			</div><!-- /.row -->
		</div><!-- /.container -->
	</header><!-- /.site-header -->


		<div class="hero-subheader">
			<div class="container">
				<div class="row">
					<div class="col-md-7">
						<div class="align-container" data-mh>
							<div class="align-inner">
								
									<h1 class="hero-subheader__title">Authenticate POS</h1>
								
								
									<p class="hero-subheader__desc">This API allows taxpayer system to get access token to be used to access other protected APIs of the solution.</p>
								
								
									
										<a href="/ereceiptapi/" class="btn btn--dark btn--rounded btn--w-icon btn--w-icon-left">
											<i class="icon icon--arrow-left"></i>
											Full eReceipt API list
										</a>
									
									
										<a href="/ereceiptapi/02-submit-receipt/" class="btn btn--dark btn--rounded btn--w-icon">
											<i class="icon icon--arrow-right"></i>
											Submit Receipt Documents
										</a>
									
								
							</div><!-- /.align-inner -->
						</div><!-- /.align-container -->
					</div><!-- /.col -->
					
				</div><!-- /.row -->
			</div><!-- /.container -->
		</div><!-- /.hero-subheader -->
		<div class="section">
			<div class="container">
				<div class="row">
					<div class="col-md-7">
						<div class="content">
							<h2 id="overview">Overview</h2>

<p>eReceipt solution APIs are protected (with some exceptions) and made available only to relevant taxpayer POS systems.</p>

<p>This API is used to authenticate the POS system calling and issue access token that allows POS system to access those protected APIs. Note that each token issued is issued for a certain time period configured as part of eReceipt solution, example can be found in <a href="#successful-response">expires_in</a>. This means that compliant POS systems integrating with the solution should expect that some calls can start returning not authorized error codes (see more on <a href="/standard-error-response/">standard error responses</a>) that mean that most likely token has expired and needs to be renewed (by another login).</p>

<div class="callout callout--info">
    <p><strong>Note!</strong> Authentication of the systems is done on identity service, not on the service hosting actual integration APIs. Use the Identity Service base address when creating the full URL to be called.</p>
</div>

<h2 id="signature">Signature</h2>

<p>As described in the <a href="/start/">Getting started overview</a>, solution is leveraging externalized standards based identity system for managing users and also systems that are accessing solution user interfaces and also APIs.</p>

<p>Therefore solution leverages <a href="https://tools.ietf.org/html/rfc6749#section-4.4">OAuth 2.0 client credentials flow</a> for authenticating systems and granting them access token that allows then to call other APIs described in this SDK that requires authorization.</p>

<p>Signature:
<code class="highlighter-rouge">POST /connect/token</code></p>

<h2 id="inputs">Inputs</h2>

<table>
  <thead>
    <tr>
      <th>Header parameter</th>
      <th>Type</th>
      <th>Description</th>
      <th>Value example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>posserial</td>
      <td>String (100)</td>
      <td>This is POS Serial Number</td>
      <td>1234567899</td>
    </tr>
    <tr>
      <td>pososversion</td>
      <td>String (50)</td>
      <td>This is POS Version Number</td>
      <td>os</td>
    </tr>
    <tr>
      <td>posmodelframework</td>
      <td>String (10)</td>
      <td>This is POS Model Framework Number</td>
      <td>1</td>
    </tr>
    <tr>
      <td>presharedkey</td>
      <td>String (200)</td>
      <td>This is POS Pre shared key</td>
      <td>03ac674216f3e1â¦</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Body parameter</th>
      <th>Type</th>
      <th>Description</th>
      <th>Value example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>grant_type</td>
      <td>String (20)</td>
      <td>Must be âclient_credentialsâ</td>
      <td>client_credentials</td>
    </tr>
    <tr>
      <td>client_id</td>
      <td>String (100)</td>
      <td>Specific client_id</td>
      <td>d0394a9f-0607-40de-a978-2d3eb8375b04</td>
    </tr>
    <tr>
      <td>client_secret</td>
      <td>String (100)</td>
      <td>specific client_secret</td>
      <td>6d62315e-d65a-4e41-9112-4195ea834edf</td>
    </tr>
  </tbody>
</table>

<h2 id="outputs">Outputs</h2>

<h3 id="successful-response">Successful Response</h3>

<p>API returns HTTP status code <code class="highlighter-rouge">200</code>.</p>

<table>
  <thead>
    <tr>
      <th>Output parameter</th>
      <th>Type</th>
      <th>Description</th>
      <th>Value example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>access_token</td>
      <td>JWT token</td>
      <td>Encoded JWT token structure that contains the fields of the issued token, token protection attributes and  TAGs assigned to the taxpayer, so that the system can access B2B or B2C features or both</td>
      <td>Encoded token value</td>
    </tr>
    <tr>
      <td>token_type</td>
      <td>String  (6)</td>
      <td>Solution in this case returns only Bearer authentication tokens</td>
      <td>Bearer</td>
    </tr>
    <tr>
      <td>expires_in</td>
      <td>Number</td>
      <td>The lifetime of the access token defined in seconds</td>
      <td>3600 (means it is valid for one hour)</td>
    </tr>
    <tr>
      <td>scope</td>
      <td>String (200)</td>
      <td>Optional if matches the requested scope. Otherwise contains information on scope granted to token. This defines the APIs that client will have access to using this token.</td>
      <td>InvoicingAPI</td>
    </tr>
  </tbody>
</table>

<h3 id="error-responses-400-bad-request">Error Responses: 400 Bad Request</h3>

<table>
  <thead>
    <tr>
      <th>Output parameter</th>
      <th>Type</th>
      <th>Description</th>
      <th>Value example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>error</td>
      <td>String</td>
      <td>Possible values: unauthorized_client, invalid_posserial, invalid_pososversion, invalid_posmodelframework, invalid_presharedkey unauthorized_client, unsupported_grant_type, invalid_scope</td>
      <td>invalid_request , invalid_clientsecret</td>
    </tr>
  </tbody>
</table>

<h2 id="additional-considerations">Additional Considerations</h2>

<p>Each token already includes information about the taxpayer that the system is going to represent, therefore when doing API calls afterwards the taxpayer information is available also to relying party APIs.</p>

<p>System authentication can be rejected if invalid client ID and secret is used to authenticate or the system user registered against the taxpayer is blocked or expired.</p>

<p>Tokens issued as a result of the login operation are valid only for a pre-configured limited time. It is configured to be 1 hour.</p>

<p><strong>Note:</strong> Your system should be responsible to obtain a new access token using this endpoint before the expiry of the current valid token to continue calling the APIs.</p>

<p><strong>Note:</strong> Only Taxpayers assigned with B2C tag will be allowed to submit receipts.</p>

						</div><!-- /.content -->
					</div><!-- /.col -->
					<div class="col-md-4 col-md-offset-1">
						<div class="sections-list-wrapper">
							<div class="sections-list js-sections js-affix js-scrollspy hidden-xs hidden-sm"></div><!-- /.sections-list -->
						</div>
					</div><!-- /.col -->
				</div><!-- /.row -->
			</div><!-- /.container -->
		</div><!-- /.section -->
		
		<div class="js-footer-area">
			
				<nav class="page-nav">
					<div class="container">
						<div class="row">
							<div class="col-xs-12">
								
									<a href="/ereceiptapi/" class="page-nav__item page-nav__item--prev">
										<i class="icon icon--arrow-left"></i>
										Full eReceipt API list
									</a><!-- /.page-nav__item -->
								
								
									<a href="/ereceiptapi/02-submit-receipt/" class="page-nav__item page-nav__item--next">
										Submit Receipt Documents
										<i class="icon icon--arrow-right"></i>
									</a><!-- /.page-nav__item -->
								
							</div><!-- /.col -->
						</div><!-- /.row -->
					</div><!-- /.container -->
				</nav><!-- /.page-nav -->
			
			
				<div class="micro-nav">
	<div class="container">
		<div class="row">
			<div class="col-xs-12">
				<a href="/" class="micro-nav__back">
					<i class="icon icon--arrow-left"></i>
					Back to homepage
				</a><!-- /.micro-nav__back -->
			</div><!-- /.col -->
		</div><!-- /.row -->
	</div><!-- /.container -->
</div><!-- /.micro-nav -->

			
			
	<footer class="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-sm-6">
					
						<a href="/" class="site-footer__logo">Egyptian eInvoicing & eReceipt SDK</a>
					
					
						<hr>
						<p class="site-footer__copyright">Copyright &copy; 2021 - <a href="/contacts/">Egyptian Tax Authority</a></p>
					
				</div><!-- /.col -->
				
			</div><!-- /.row -->
		</div><!-- /.container -->
	</footer><!-- /.site-footer -->


<script src="/doks-theme/assets/js/vendor/jquery.min.js"></script>
<script type="text/javascript" src="/doks-theme/assets/js/vendor/bootstrap/affix.min.js"></script>
<script type="text/javascript" src="/doks-theme/assets/js/vendor/bootstrap/scrollspy.min.js"></script>
<script type="text/javascript" src="/doks-theme/assets/js/vendor/matchHeight.min.js"></script>
<script type="text/javascript" src="/doks-theme/assets/js/scripts.min.js"></script>




		</div><!-- /.js-footer-area -->
	</body>
</html>
<script id="f5_cspm">(function(){var f5_cspm={f5_p:'HLGEJNEAHLDGKKLMNGMDEDKIIHABNODCDMGOMOJLNAGPDJCNPKKFCOJHFPCHLLMEBIBBGIOKAAAFAMBIDIJAMCMCAAIOPLBONDPLGDEJOKICDKEAFIPAPFELMCCIOOBE',setCharAt:function(str,index,chr){if(index>str.length-1)return str;return str.substr(0,index)+chr+str.substr(index+1);},get_byte:function(str,i){var s=(i/16)|0;i=(i&15);s=s*32;return((str.charCodeAt(i+16+s)-65)<<4)|(str.charCodeAt(i+s)-65);},set_byte:function(str,i,b){var s=(i/16)|0;i=(i&15);s=s*32;str=f5_cspm.setCharAt(str,(i+16+s),String.fromCharCode((b>>4)+65));str=f5_cspm.setCharAt(str,(i+s),String.fromCharCode((b&15)+65));return str;},set_latency:function(str,latency){latency=latency&0xffff;str=f5_cspm.set_byte(str,40,(latency>>8));str=f5_cspm.set_byte(str,41,(latency&0xff));str=f5_cspm.set_byte(str,35,2);return str;},wait_perf_data:function(){try{var wp=window.performance.timing;if(wp.loadEventEnd>0){var res=wp.loadEventEnd-wp.navigationStart;if(res<60001){var cookie_val=f5_cspm.set_latency(f5_cspm.f5_p,res);window.document.cookie='f5avr2091650756aaaaaaaaaaaaaaaa_cspm_='+encodeURIComponent(cookie_val)+';path=/;'+'';}
return;}}
catch(err){return;}
setTimeout(f5_cspm.wait_perf_data,100);return;},go:function(){var chunk=window.document.cookie.split(/\s*;\s*/);for(var i=0;i<chunk.length;++i){var pair=chunk[i].split(/\s*=\s*/);if(pair[0]=='f5_cspm'&&pair[1]=='1234')
{var d=new Date();d.setTime(d.getTime()-1000);window.document.cookie='f5_cspm=;expires='+d.toUTCString()+';path=/;'+';';setTimeout(f5_cspm.wait_perf_data,100);}}}}
f5_cspm.go();}());</script>
